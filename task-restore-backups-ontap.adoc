---
sidebar: sidebar 
permalink: task-restore-backups-ontap.html 
keywords: restoring, restore, restore volumes, restore files, restore folders, cloud backup, file restore, single file restore, folder restore, volume restore, browse and restore, search and restore, ONTAP 
summary: Los backups se almacenan en un almacén de objetos en su cuenta de cloud para que pueda restaurar datos desde un momento específico. Es posible restaurar un volumen completo de ONTAP desde un archivo de backup o si solo es necesario restaurar unos pocos archivos, puede restaurar una carpeta o archivos individuales desde un archivo de backup. 
---
= Restaurar datos ONTAP a partir de archivos de backup
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Los backups se almacenan en un almacén de objetos en su cuenta de cloud para que pueda restaurar datos desde un momento específico. Es posible restaurar un volumen completo de ONTAP desde un archivo de backup o si solo es necesario restaurar unos pocos archivos, puede restaurar una carpeta o archivos individuales desde un archivo de backup.

Puede restaurar un *volumen* (como un volumen nuevo) al entorno de trabajo original, a un entorno de trabajo diferente que utiliza la misma cuenta de cloud o a un sistema ONTAP local.

Puede restaurar una carpeta ** en un volumen del entorno de trabajo original, en un volumen de un entorno de trabajo diferente que utiliza la misma cuenta de cloud o en un volumen de un sistema ONTAP local.

Puede restaurar *archivos* en un volumen del entorno de trabajo original, en un volumen de un entorno de trabajo diferente que utiliza la misma cuenta de cloud o en un volumen de un sistema ONTAP local.

Se necesita una licencia de Cloud Backup válida para restaurar datos de archivos de backup a un sistema de producción.



== La Consola de restauración

Restore Dashboard se utiliza para realizar operaciones de volumen, carpeta y restauración de archivos. Para acceder al Panel de restauración, haga clic en *copia de seguridad y recuperación* en el menú BlueXP y, a continuación, haga clic en la ficha *Restaurar*. También puede hacer clic en image:screenshot_gallery_options.gif["Botón más"] > *Ver el Panel de restauración* desde el servicio de copia de seguridad y recuperación desde el panel Servicios.


NOTE: Cloud Backup debe estar activado como mínimo en un entorno de trabajo y deben existir archivos de backup iniciales.

image:screenshot_restore_dashboard.png["El Panel de restauración muestra las opciones para utilizar la función examinar  Restaurar o Buscar  Restaurar."]

Como puede ver, Restore Dashboard ofrece dos formas diferentes de restaurar datos de archivos de copia de seguridad: *Browse & Restore* y *Search & Restore*.



== Comparación de examinar y restaurar y buscar y restaurar

En términos generales, _Browse & Restore_ suele ser mejor cuando necesita restaurar un volumen, carpeta o archivo específico de la última semana o mes, y sabe el nombre y la ubicación del archivo y la fecha en la que estaba en buen estado. _Search & Restore_ suele ser mejor cuando necesita restaurar un volumen, una carpeta o un archivo, pero no recuerda el nombre exacto, ni el volumen en el que reside, ni la fecha en la que estaba en buen estado por última vez.

Esta tabla proporciona una comparación de los 2 métodos.

[cols="50,50"]
|===
| Examinar y restaurar | Búsqueda y restauración 


| Examine una estructura de tipo carpeta para buscar el volumen, carpeta o archivo dentro de un único archivo de copia de seguridad | Busque un volumen, carpeta o archivo en *todos los archivos de copia de seguridad* por nombre de volumen parcial o completo, nombre de carpeta/archivo parcial o completo, intervalo de tamaño y filtros de búsqueda adicionales 


| La restauración de volúmenes y archivos funciona con archivos de backup almacenados en Amazon S3, Azure Blob, Google Cloud y NetApp StorageGRID | La restauración de volúmenes y archivos funciona con archivos de backup almacenados en Amazon S3, Azure Blob, Google Cloud y NetApp StorageGRID 


| Restaurar volúmenes, carpetas y archivos desde StorageGRID en sitios sin acceso a Internet | Restaurar volúmenes, carpetas y archivos desde StorageGRID en sitios sin acceso a Internet 


| No gestiona la recuperación de archivos si el archivo se ha eliminado o cambiado de nombre y el usuario no conoce el nombre de archivo original | Controla los directorios recién creados, eliminados y renombrados y los archivos recién creados, eliminados y renombrados 


| Busque resultados en clouds públicos y privados | Busque resultados en clouds públicos y copias Snapshot locales 


| No se requieren recursos de proveedor de cloud adicionales | Se requieren recursos de bloque y proveedor de cloud público adicionales por cuenta 


| No requiere costes de proveedor de cloud adicionales | Coste asociado con los recursos del proveedor de cloud público al analizar sus backups y volúmenes para obtener resultados de búsqueda 
|===
Antes de poder utilizar cualquiera de estos métodos de restauración, asegúrese de haber configurado el entorno para los requisitos específicos de recurso. Estos requisitos se describen en las secciones siguientes.

Consulte los requisitos y los pasos de restauración para el tipo de operación de restauración que desea usar:

* <<Restoring volumes using Browse & Restore,Restaure volúmenes mediante la función examinar  Restore
* <<Restoring folders and files using Browse & Restore,Restaure carpetas y archivos utilizando examinar  Restore
* <<Restoring ONTAP data using Search & Restore,Restaure volúmenes, carpetas y archivos mediante la función de restauración de  de búsqueda




== Restaurar datos de ONTAP mediante examinar y restaurar

Antes de empezar a restaurar un volumen, una carpeta o un archivo, debe conocer el nombre del volumen desde el que desea restaurar, el nombre del entorno de trabajo y la SVM donde reside el volumen, así como la fecha aproximada del archivo de backup del que desea restaurar.

*Nota:* Si el archivo de copia de seguridad que contiene los datos que desea restaurar reside en el almacenamiento de archivado (a partir de ONTAP 9.10.1), la operación de restauración tardará más tiempo y incurrirá en un costo. Además, el clúster de destino también debe ejecutar ONTAP 9.10.1 o superior para la restauración de volúmenes, 9.11.1 para la restauración de archivos y 9.12.1 para Google Archive y StorageGRID.

ifdef::aws[]

link:reference-aws-backup-tiers.html["Obtenga más información sobre la restauración a partir del almacenamiento de archivado de AWS"].

endif::aws[]

ifdef::azure[]

link:reference-azure-backup-tiers.html["Obtenga más información sobre la restauración a partir del almacenamiento de archivado de Azure"].

endif::azure[]

ifdef::gcp[]

link:reference-google-backup-tiers.html["Más información sobre cómo restaurar a partir del almacenamiento de archivado de Google"].

endif::gcp[]


NOTE: La prioridad alta no es compatible cuando se restauran datos desde Azure a sistemas StorageGRID.



=== Examinar y restaurar entornos de trabajo compatibles y proveedores de almacenamiento de objetos

Es posible restaurar un volumen, una carpeta o archivos individuales, desde un archivo de backup de ONTAP a los siguientes entornos de trabajo:

[cols="50,50"]
|===
| Ubicación del archivo de copia de seguridad | Entorno de trabajo de destino ifdef::aws[] 


| Amazon S3 | Cloud Volumes ONTAP en la endif del sistema ONTAP en las instalaciones de AWS::aws[] ifdef::Azure[] 


| Azure Blob | Cloud Volumes ONTAP en Azure on-premises ONTAP system endif::Azure[] ifdef::gcp[] 


| Google Cloud Storage | Cloud Volumes ONTAP en Google on-local ONTAP system endif::gcp[] 


| StorageGRID de NetApp | Sistema ONTAP en las instalaciones 
|===
Para examinar y restaurar, el conector se puede instalar en las siguientes ubicaciones:

ifdef::aws[]

* Para Amazon S3, el conector puede ponerse en marcha en AWS o en sus instalaciones


endif::aws[]

ifdef::azure[]

* Para Azure Blob, el conector se puede poner en marcha en Azure o en sus instalaciones


endif::azure[]

ifdef::gcp[]

* Para Google Cloud Storage, el conector se debe poner en marcha en su VPC de Google Cloud Platform


endif::gcp[]

* Para StorageGRID, el conector debe estar desplegado en sus instalaciones, con o sin acceso a Internet


Tenga en cuenta que las referencias a "sistemas ONTAP en las instalaciones" incluyen sistemas FAS, AFF y ONTAP Select.


NOTE: No se pueden restaurar carpetas o archivos si el archivo de copia de seguridad se ha configurado con DataLock & Ransomware. En este caso, es posible restaurar todo el volumen desde el archivo de backup y, a continuación, acceder a los archivos necesarios.



=== Restaurar volúmenes mediante Browse y Restore

Al restaurar un volumen a partir de un archivo de copia de seguridad, Cloud Backup crea un volumen _new_ utilizando los datos de la copia de seguridad. Puede restaurar los datos en un volumen del entorno de trabajo original o en otro entorno de trabajo ubicado en la misma cuenta de cloud que el entorno de trabajo de origen. También es posible restaurar volúmenes en un sistema ONTAP en las instalaciones.

image:diagram_browse_restore_volume.png["Diagrama que muestra el flujo para realizar una operación de restauración de volumen mediante examinar  Restore."]

Como puede ver, necesita conocer el nombre del entorno de trabajo, la máquina virtual de almacenamiento, el nombre del volumen y la fecha del archivo de backup para restaurar un volumen.

En el siguiente vídeo se muestra un tutorial rápido sobre cómo restaurar un volumen:

video::9Og5agUWyRk[youtube,width=848,height=480,end=164]
.Pasos
. En el menú BlueXP, seleccione *Protección > copia de seguridad y recuperación*.
. Haga clic en la ficha *Restaurar* y aparecerá el Panel de restauración.
. En la sección _Browse & Restore_, haga clic en *Restore Volume*.
+
image:screenshot_restore_volume_selection.png["Captura de pantalla de la selección del botón Restaurar volúmenes del Panel de restauración."]

. En la página _Select Source_, desplácese hasta el archivo de copia de seguridad del volumen que desea restaurar. Seleccione *entorno de trabajo*, *volumen* y el archivo *copia de seguridad* que tiene la Marca de fecha/hora desde la que desea restaurar.
+
image:screenshot_restore_select_volume_snapshot.png["Captura de pantalla de selección del entorno de trabajo, volumen y archivo de copia de seguridad de volumen que desea restaurar."]

. Haga clic en *Siguiente*.
+
Tenga en cuenta que si la protección contra ransomware está activa para el archivo de copia de seguridad (si habilitó DataLock y la protección contra ransomware en la política de copia de seguridad), se le solicitará que ejecute un análisis adicional de ransomware en el archivo de copia de seguridad antes de restaurar los datos. Se recomienda que escanee el archivo de backup como ransomware.

. En la página _Select Destination_, seleccione *entorno de trabajo* donde desea restaurar el volumen.
+
image:screenshot_restore_select_work_env_volume.png["Captura de pantalla de selección del entorno de trabajo de destino para el volumen que desea restaurar."]

. Si selecciona un sistema ONTAP en las instalaciones y todavía no ha configurado la conexión de clúster con el almacenamiento de objetos, se le pedirá información adicional:
+
ifdef::aws[]

+
** Al restaurar desde Amazon S3, seleccione el espacio IP del clúster de ONTAP en el que residirá el volumen de destino, introduzca la clave de acceso y la clave secreta del usuario que creó para permitir el acceso del clúster ONTAP al bloque de S3, Y, opcionalmente, elegir un extremo privado VPC para una transferencia de datos segura.




endif::aws[]

ifdef::azure[]

* Al restaurar desde Azure Blob, seleccione el espacio IP en el clúster de ONTAP donde reside el volumen de destino, seleccione la suscripción de Azure para acceder al almacenamiento de objetos y, opcionalmente, elija un extremo privado para la transferencia de datos segura mediante la selección de la red y la subred.


endif::azure[]

ifdef::gcp[]

* Al restaurar desde Google Cloud Storage, seleccione Google Cloud Project y Access Key y Secret Key para acceder al almacenamiento de objetos, la región donde se almacenan los backups y el espacio IP del clúster de ONTAP donde reside el volumen de destino.


endif::gcp[]

* Al restaurar desde StorageGRID, introduzca el FQDN del servidor StorageGRID y el puerto que ONTAP debe usar para la comunicación HTTPS con StorageGRID, seleccione la clave de acceso y la clave secreta necesarias para acceder al almacenamiento de objetos, y el espacio IP del clúster ONTAP donde reside el volumen de destino.
+
.. Introduzca el nombre que desea usar para el volumen restaurado y seleccione la máquina virtual de almacenamiento y el agregado donde reside el volumen. Al restaurar un volumen de FlexGroup, puede elegir varios agregados. De forma predeterminada, se utiliza *<source_volume_name>_restore* como nombre del volumen.
+
image:screenshot_restore_new_vol_name.png["Captura de pantalla de introducción del nombre del nuevo volumen que desea restaurar."]

+
Además, si va a restaurar el volumen a partir de un archivo de backup que reside en un nivel de almacenamiento de archivado (disponible a partir de ONTAP 9.10.1), puede seleccionar la prioridad de restauración.

+
ifdef::aws[]





link:reference-aws-backup-tiers.html#restoring-data-from-archival-storage["Obtenga más información sobre la restauración a partir del almacenamiento de archivado de AWS"].

endif::aws[]

ifdef::azure[]

link:reference-azure-backup-tiers.html#restoring-data-from-archival-storage["Obtenga más información sobre la restauración a partir del almacenamiento de archivado de Azure"].

endif::azure[]

ifdef::gcp[]

link:reference-google-backup-tiers.html#restoring-data-from-archival-storage["Más información sobre cómo restaurar a partir del almacenamiento de archivado de Google"]. Los archivos de copia de seguridad del nivel de almacenamiento de Google Archive se restauran casi inmediatamente y no requieren prioridad de restauración.

endif::gcp[]

. Haga clic en *Restaurar* y volverá al Panel de restauración para que pueda revisar el progreso de la operación de restauración.


.Resultado
Cloud Backup crea un nuevo volumen según el backup seleccionado. Puede hacerlo link:task-manage-backups-ontap.html["gestione la configuración de backup para este nuevo volumen"] según sea necesario.

Tenga en cuenta que la restauración de un volumen a partir de un archivo de backup que reside en el almacenamiento de archivado puede tardar varios minutos u horas, según el nivel de archivado y la prioridad de restauración. Puede hacer clic en la ficha *Supervisión de trabajos* para ver el progreso de la restauración.



=== Restaurar carpetas y archivos mediante Browse & Restore

Si solo necesita restaurar algunos archivos desde un backup de volumen de ONTAP, puede optar por restaurar una carpeta o archivos individuales en lugar de restaurar el volumen completo. Es posible restaurar carpetas y archivos a un volumen existente en el entorno de trabajo original o a un entorno de trabajo diferente que utilice la misma cuenta de cloud. También puede restaurar carpetas y archivos en un volumen de un sistema ONTAP en las instalaciones.

Si selecciona varios archivos, todos los archivos se restauran en el mismo volumen de destino que se elija. Por lo tanto, si desea restaurar archivos en diferentes volúmenes, deberá ejecutar el proceso de restauración varias veces.

En este momento, puede seleccionar y restaurar únicamente una carpeta. Y solo se restauran los archivos de esa carpeta. No se restauran carpetas secundarias ni archivos en subcarpetas.

[NOTE]
====
* Actualmente, no se admite la restauración a nivel de carpeta si el archivo de backup se configuró con DataLock y Ransomware. En este caso, es posible restaurar todo el volumen desde el archivo de backup y, a continuación, acceder a la carpeta y los archivos necesarios.
* Actualmente, no se admite la restauración a nivel de carpeta si el archivo de backup reside en el almacenamiento de archivado. En este caso, puede restaurar la carpeta desde un nuevo archivo de copia de seguridad que no se haya archivado o restaurar todo el volumen desde la copia de seguridad archivada y, a continuación, acceder a la carpeta y los archivos que necesite.


====


==== Requisitos previos

* La versión de ONTAP debe ser 9.6 o superior para realizar operaciones de restauración _File_.
* La versión de ONTAP debe ser 9.11.1 o superior para realizar operaciones de restauración de _folder_. ifdef::aws[]


endif::aws[]



==== Proceso de restauración de carpetas y archivos

El proceso va como este:

. Cuando desee restaurar una carpeta o uno o más archivos desde una copia de seguridad de volumen, haga clic en la ficha *Restaurar* y haga clic en *Restaurar archivos o carpeta* en _Browse & Restore_.
. Seleccione el entorno de trabajo de origen, el volumen y el archivo de copia de seguridad en el que residen la carpeta o los archivos.
. Cloud Backup muestra las carpetas y los archivos que existen dentro del archivo de copia de seguridad seleccionado.
. Seleccione la carpeta o los archivos que desea restaurar a partir de esa copia de seguridad.
. Seleccione la ubicación de destino en la que desea restaurar la carpeta o los archivos (el entorno de trabajo, el volumen y la carpeta) y haga clic en *Restaurar*.
. Se restauran los archivos.


image:diagram_browse_restore_file.png["Diagrama que muestra el flujo para realizar una operación de restauración de archivos mediante examinar  Restore."]

Como puede ver, necesita conocer el nombre del entorno de trabajo, el nombre del volumen, la fecha del archivo de copia de seguridad y el nombre de carpeta/archivo para realizar una restauración de carpetas o archivos.



==== Restauración de carpetas y archivos

Siga estos pasos para restaurar carpetas o archivos en un volumen a partir de un backup de volumen de ONTAP. Debe conocer el nombre del volumen y la fecha del archivo de backup que desea utilizar para restaurar la carpeta o los archivos. Esta funcionalidad utiliza Live Browsing para que pueda ver la lista de directorios y archivos dentro de cada archivo de copia de seguridad.

El siguiente vídeo muestra un tutorial rápido sobre cómo restaurar un único archivo:

video::9Og5agUWyRk[youtube,width=848,height=480,start=165]
.Pasos
. En el menú BlueXP, seleccione *Protección > copia de seguridad y recuperación*.
. Haga clic en la ficha *Restaurar* y aparecerá el Panel de restauración.
. En la sección _Browse & Restore_, haga clic en *Restaurar archivos o carpeta*.
+
image:screenshot_restore_files_selection.png["Captura de pantalla de la selección del botón Restaurar archivos o carpeta del Panel de restauración."]

. En la página _Select Source_, desplácese hasta el archivo de copia de seguridad del volumen que contiene la carpeta o los archivos que desea restaurar. Seleccione *entorno de trabajo*, *volumen* y *copia de seguridad* que tenga la Marca de fecha/hora desde la que desea restaurar archivos.
+
image:screenshot_restore_select_source.png["Captura de pantalla de selección del volumen y copia de seguridad para los elementos que desea restaurar."]

. Haga clic en *Siguiente* y aparecerá la lista de carpetas y archivos de la copia de seguridad de volumen.
+
Si va a restaurar carpetas o archivos desde un archivo de copia de seguridad que reside en un nivel de almacenamiento de archivado (disponible a partir de ONTAP 9.10.1), puede seleccionar la prioridad de restauración.

+
ifdef::aws[]



link:reference-aws-backup-tiers.html#restoring-data-from-archival-storage["Obtenga más información sobre la restauración a partir del almacenamiento de archivado de AWS"].

endif::aws[]

ifdef::azure[]

link:reference-azure-backup-tiers.html#restoring-data-from-archival-storage["Obtenga más información sobre la restauración a partir del almacenamiento de archivado de Azure"].

endif::azure[]

ifdef::gcp[]

link:reference-google-backup-tiers.html#restoring-data-from-archival-storage["Más información sobre cómo restaurar a partir del almacenamiento de archivado de Google"]. Los archivos de copia de seguridad del nivel de almacenamiento de Google Archive se restauran casi inmediatamente y no requieren prioridad de restauración.

endif::gcp[]

+ y si la protección contra ransomware está activa para el archivo de copia de seguridad (si habilitó DataLock y la protección contra ransomware en la política de copia de seguridad), se le solicitará que ejecute un análisis adicional de ransomware en el archivo de copia de seguridad antes de restaurar los datos. Se recomienda que escanee el archivo de backup como ransomware.

+image:screenshot_restore_select_files.png["Captura de pantalla de la página Seleccionar elementos para que pueda desplazarse a los elementos que desea restaurar."]

. En la página _Select ITEMS_, seleccione la carpeta o los archivos que desea restaurar y haga clic en *continuar*. Para ayudarle a encontrar el elemento:
+
** Si lo ve, puede hacer clic en la carpeta o en el nombre del archivo.
** Puede hacer clic en el icono de búsqueda e introducir el nombre de la carpeta o archivo para desplazarse directamente al elemento.
** Puede desplazarse por los niveles de las carpetas mediante image:button_subfolder.png[""] al final de la fila para buscar archivos específicos.
+
A medida que seleccione los archivos, se agregarán a la parte izquierda de la página para que pueda ver los archivos que ya ha elegido. Si es necesario, puede eliminar un archivo de esta lista haciendo clic en *x* junto al nombre del archivo.



. En la página _Select Destination_, seleccione *entorno de trabajo* donde desea restaurar los elementos.
+
image:screenshot_restore_select_work_env.png["Captura de pantalla de selección del entorno de trabajo de destino para los elementos que desea restaurar."]

+
Si selecciona un clúster en las instalaciones y no ha configurado todavía la conexión de clúster con el almacenamiento de objetos, se le pedirá información adicional:

+
ifdef::aws[]

+
** Al restaurar desde Amazon S3, introduzca el espacio IP del clúster de ONTAP donde se encuentra el volumen de destino y la clave secreta y de acceso AWS se necesitan para acceder al almacenamiento de objetos. También puede seleccionar una configuración de vínculo privado para la conexión al clúster.




endif::aws[]

ifdef::azure[]

* Al restaurar desde Azure Blob, introduzca el espacio IP en el clúster de ONTAP donde reside el volumen de destino. También puede seleccionar una configuración de extremo privado para la conexión con el clúster.


endif::azure[]

ifdef::gcp[]

* Al restaurar desde Google Cloud Storage, introduzca el espacio IP en el clúster de ONTAP en el que residen los volúmenes de destino y la clave secreta y de acceso necesaria para acceder al almacenamiento de objetos.


endif::gcp[]

* Al restaurar desde StorageGRID, introduzca el FQDN del servidor StorageGRID y el puerto que ONTAP debe usar para la comunicación HTTPS con StorageGRID, introduzca la clave de acceso y la clave secreta necesarias para acceder al almacenamiento de objetos, y el espacio IP del clúster ONTAP en el que reside el volumen de destino.
+
.. A continuación, seleccione *volumen* y *carpeta* donde desea restaurar la carpeta o los archivos.
+
image:screenshot_restore_select_dest.png["Captura de pantalla de selección del volumen y la carpeta para los archivos que desea restaurar."]

+
Tiene varias opciones para la ubicación al restaurar carpetas y archivos.



* Cuando haya elegido *Seleccionar carpeta de destino*, como se muestra arriba:
+
** Puede seleccionar cualquier carpeta.
** Puede pasar el ratón sobre una carpeta y hacer clic en image:button_subfolder.png[""] al final de la fila para explorar subcarpetas y, a continuación, seleccione una carpeta.


* Si ha seleccionado el mismo entorno de trabajo y volumen de destino en el que se encontraba la carpeta/archivo de origen, puede seleccionar *mantener ruta de carpeta de origen* para restaurar la carpeta o archivos a la misma carpeta en la que existían en la estructura de origen. Ya deben existir todas las mismas carpetas y subcarpetas; no se crean las carpetas. Al restaurar los archivos a su ubicación original, puede elegir sobrescribir los archivos de origen o crear nuevos archivos.
+
.. Haga clic en *Restaurar* y volverá al Panel de restauración para que pueda revisar el progreso de la operación de restauración. También puede hacer clic en la ficha *Supervisión de trabajos* para ver el progreso de la restauración.






== Restaurar datos de ONTAP mediante la opción Buscar y restaurar

Es posible restaurar un volumen, una carpeta o archivos desde un archivo de backup de ONTAP mediante Search & Restore. Search & Restore le permite buscar un volumen, una carpeta o un archivo específicos a partir de todos los backups almacenados en el almacenamiento en cloud para un proveedor en concreto y, a continuación, llevar a cabo una restauración. No necesita conocer el nombre exacto del entorno de trabajo o el nombre del volumen; la búsqueda se realiza mediante todos los archivos de backup de volúmenes.

La operación de búsqueda también busca todas las copias Snapshot locales que existen también para los volúmenes ONTAP. Como la restauración de datos de una copia Snapshot local puede ser más rápida y económica que la restauración desde un archivo de respaldo, es posible que desee restaurar datos de la copia Snapshot. Puede restaurar la snapshot como un volumen nuevo https://docs.netapp.com/us-en/cloud-manager-cloud-volumes-ontap/task-manage-volumes.html#manage-volumes["Desde la página Detalles de volumen del lienzo"^] (No de Cloud Backup).

Al restaurar un volumen a partir de un archivo de copia de seguridad, Cloud Backup crea un volumen _new_ utilizando los datos de la copia de seguridad. Puede restaurar los datos como un volumen en el entorno de trabajo original o a un entorno de trabajo diferente ubicado en la misma cuenta de cloud que el entorno de trabajo de origen. También es posible restaurar volúmenes en un sistema ONTAP en las instalaciones.

Es posible restaurar carpetas o archivos en la ubicación del volumen original, a un volumen diferente del mismo entorno de trabajo o a un entorno de trabajo diferente que utilice la misma cuenta de cloud. También puede restaurar carpetas y archivos en un volumen de un sistema ONTAP en las instalaciones.

Si el archivo de backup del volumen que desea restaurar reside en el almacenamiento de archivado (disponible a partir de ONTAP 9.10.1), la operación de restauración tardará más tiempo y generará costes adicionales. Tenga en cuenta que el clúster de destino también debe ejecutar ONTAP 9.10.1 o superior para la restauración de volúmenes, 9.11.1 para la restauración de archivos y 9.12.1 para Google Archive y StorageGRID.

ifdef::aws[]

link:reference-aws-backup-tiers.html["Obtenga más información sobre la restauración a partir del almacenamiento de archivado de AWS"].

endif::aws[]

ifdef::azure[]

link:reference-azure-backup-tiers.html["Obtenga más información sobre la restauración a partir del almacenamiento de archivado de Azure"].

endif::azure[]

ifdef::gcp[]

link:reference-google-backup-tiers.html["Más información sobre cómo restaurar a partir del almacenamiento de archivado de Google"].

endif::gcp[]

[NOTE]
====
* Actualmente, no se admite la restauración a nivel de carpeta si el archivo de backup se configuró con DataLock y Ransomware. En este caso, es posible restaurar todo el volumen desde el archivo de backup y, a continuación, acceder a la carpeta y los archivos necesarios.
* Actualmente, no se admite la restauración a nivel de carpeta si el archivo de backup reside en el almacenamiento de archivado. En este caso, puede restaurar la carpeta desde un nuevo archivo de copia de seguridad que no se haya archivado o restaurar todo el volumen desde la copia de seguridad archivada y, a continuación, acceder a la carpeta y los archivos que necesite.
* La prioridad de restauración alta no es compatible cuando se restauran los datos de Azure a los sistemas StorageGRID.


====
Antes de empezar, debe tener idea del nombre o la ubicación del volumen o el archivo que desea restaurar.

El siguiente vídeo muestra un tutorial rápido sobre cómo restaurar un único archivo:

video::RZktLe32hhQ[youtube,width=848,height=480]


=== Entornos de trabajo compatibles con Search & Restore y proveedores de almacenamiento de objetos

Es posible restaurar un volumen, una carpeta o archivos individuales, desde un archivo de backup de ONTAP a los siguientes entornos de trabajo:

[cols="35,45"]
|===
| Ubicación del archivo de copia de seguridad | Entorno de trabajo de destino ifdef::aws[] 


| Amazon S3 | Cloud Volumes ONTAP en la endif del sistema ONTAP en las instalaciones de AWS::aws[] ifdef::Azure[] 


| Azure Blob | Cloud Volumes ONTAP en Azure on-premises ONTAP system endif::Azure[] ifdef::gcp[] 


| Google Cloud Storage | Cloud Volumes ONTAP en Google on-local ONTAP system endif::gcp[] 


| StorageGRID de NetApp | Sistema ONTAP en las instalaciones 
|===
Para Buscar y restaurar, el conector se puede instalar en las siguientes ubicaciones:

ifdef::aws[]

* Para Amazon S3, el conector puede ponerse en marcha en AWS o en sus instalaciones


endif::aws[]

ifdef::azure[]

* Para Azure Blob, el conector se puede poner en marcha en Azure o en sus instalaciones


endif::azure[]

ifdef::gcp[]

* Para Google Cloud Storage, el conector se debe poner en marcha en su VPC de Google Cloud Platform


endif::gcp[]

* Para StorageGRID, el conector debe estar desplegado en sus instalaciones, con o sin acceso a Internet


Tenga en cuenta que las referencias a "sistemas ONTAP en las instalaciones" incluyen sistemas FAS, AFF y ONTAP Select.



=== Requisitos previos

* Requisitos del clúster:
+
** La versión de ONTAP debe ser 9.8 o superior.
** La máquina virtual de almacenamiento (SVM) en la que reside el volumen debe tener una LIF de datos configurada.
** Debe habilitarse NFS en el volumen (se admiten los volúmenes NFS y SMB/CIFS).
** El servidor RPC de SnapDiff debe estar activado en la SVM. BlueXP hace esto automáticamente al activar la indización en el entorno de trabajo. (SnapDiff es la tecnología que identifica rápidamente las diferencias entre los ficheros y los directorios entre dos copias snapshot).




ifdef::aws[]

* Requisitos de AWS:
+
** Deben añadirse permisos específicos de Amazon Athena, AWS Glue y AWS S3 a la función de usuario que proporciona BlueXP con permisos. link:task-backup-onprem-to-aws.html#set-up-s3-permissions["Asegúrese de que todos los permisos estén configurados correctamente"].
+
Tenga en cuenta que si ya estaba utilizando Cloud Backup con un conector configurado anteriormente, tendrá que agregar los permisos Athena y Glue al rol de usuario de BlueXP ahora. Estos son nuevos y se requieren para buscar y restaurar.





endif::aws[]

ifdef::azure[]

* Requisitos de Azure:
+
** Debe registrar el proveedor de recursos de Azure Synapse Analytics (llamado "Microsoft.Synapse") en su suscripción. https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/resource-providers-and-types#register-resource-provider["Vea cómo registrar este proveedor de recursos para su suscripción"^]. Debe ser Subscription *Owner* o *Contributor* para registrar el proveedor de recursos.
** Los permisos específicos de cuentas de almacenamiento de áreas de trabajo y lagos de datos de Azure Synapse deben agregarse a la función de usuario que proporciona permisos a BlueXP. link:task-backup-onprem-to-azure.html#verify-or-add-permissions-to-the-connector["Asegúrese de que todos los permisos estén configurados correctamente"].
+
Tenga en cuenta que si ya estaba utilizando Cloud Backup con un conector configurado anteriormente, tendrá que agregar los permisos de cuenta de Azure Synapse Workspace y de almacenamiento de lagos de datos al rol de usuario de BlueXP ahora. Estos son nuevos y se requieren para buscar y restaurar.

** El conector debe configurarse *sin* un servidor proxy para la comunicación HTTP a Internet. Si ha configurado un servidor proxy HTTP para el conector, no puede utilizar la función Buscar y reemplazar.




endif::azure[]

ifdef::gcp[]

* Requisitos de Google Cloud:
+
** Se deben agregar permisos específicos de Google BigQuery a la función de usuario que proporciona permisos a BlueXP. link:task-backup-onprem-to-gcp.html#verify-or-add-permissions-to-the-connector["Asegúrese de que todos los permisos estén configurados correctamente"].
+
Tenga en cuenta que si ya estaba utilizando Cloud Backup con un conector configurado anteriormente, tendrá que agregar los permisos BigQuery a la función de usuario de BlueXP ahora. Estos son nuevos y se requieren para buscar y restaurar.





endif::gcp[]

* Requisitos de StorageGRID:
+
Dependiendo de la configuración, hay dos formas de implementar Search & Restore:

+
** Si su cuenta no tiene credenciales de proveedor de cloud, la información del catálogo indexado se almacena en el conector.
** Si está utilizando un conector en un sitio oscuro, la información del catálogo indexado se almacena en el conector (requiere la versión 3.9.25 o superior del conector).
** Si lo tiene https://docs.netapp.com/us-en/cloud-manager-setup-admin/concept-accounts-aws.html["Credenciales de AWS"^] o. https://docs.netapp.com/us-en/cloud-manager-setup-admin/concept-accounts-azure.html["Credenciales de Azure"^] En la cuenta, el catálogo indexado se almacena en el proveedor de cloud, al igual que con un conector puesto en marcha en el cloud. (Si tiene ambas credenciales, AWS está seleccionado de forma predeterminada.)
+
Aunque utilice un conector en las instalaciones, deben cumplir los requisitos del proveedor de cloud tanto para los permisos de Connector como para los recursos del proveedor de cloud. Consulte los requisitos anteriores de AWS y Azure al utilizar esta implementación.







=== Proceso de búsqueda y restauración

El proceso va como este:

. Para poder utilizar Search & Restore, debe habilitar "Indexing" en cada entorno de trabajo de origen desde el que desea restaurar datos de volumen. De este modo, el catálogo indexado puede realizar un seguimiento de los archivos de copia de seguridad de cada volumen.
. Cuando desee restaurar un volumen o archivos de una copia de seguridad de volumen, en _Search & Restore_, haga clic en *Search & Restore*.
. Introduzca los criterios de búsqueda para un volumen, carpeta o archivo por nombre parcial o completo, nombre parcial o completo del archivo, intervalo de tamaño, intervalo de fechas de creación, otros filtros de búsqueda y haga clic en *Buscar*.
+
La página resultados de la búsqueda muestra todas las ubicaciones que tienen un archivo o volumen que coincide con sus criterios de búsqueda.

. Haga clic en *Ver todas las copias de seguridad* para la ubicación que desee utilizar para restaurar el volumen o el archivo y, a continuación, haga clic en *Restaurar* en el archivo de copia de seguridad real que desee utilizar.
. Seleccione la ubicación en la que desea restaurar el volumen, la carpeta o los archivos y haga clic en *Restaurar*.
. Se restauran el volumen, la carpeta o los archivos.


image:diagram_search_restore_vol_file.png["Diagrama que muestra el flujo para realizar una operación de restauración de volúmenes, carpetas o archivos mediante Search  Restore."]

Como puede ver, sólo necesita conocer un nombre parcial y las búsquedas de Cloud Backup en todos los archivos de copia de seguridad que coincidan con su búsqueda.



=== Activación del catálogo indexado para cada entorno de trabajo

Antes de poder utilizar Buscar y restaurar, debe habilitar la función "indexación" en cada entorno de trabajo de origen desde el que planea restaurar volúmenes o archivos. Esto permite al catálogo indexado realizar un seguimiento de cada volumen y cada archivo de copia de seguridad, lo que hace que las búsquedas sean muy rápidas y eficaces.

Al habilitar esta funcionalidad, Cloud Backup habilita SnapDiff v3 en la SVM para sus volúmenes y realiza las siguientes acciones:

ifdef::aws[]

* Para los backups almacenados en AWS, aprovisiona un nuevo bloque de S3 y el https://aws.amazon.com/athena/faqs/["Servicio de consultas interactivas de Amazon Athena"^] y.. https://aws.amazon.com/glue/faqs/["Servicio de integración de datos sin servidor de AWS"^].


endif::aws[]

ifdef::azure[]

* Para los backups almacenados en Azure, aprovisiona un espacio de trabajo Azure Synapse y un sistema de archivos Data Lake como el contenedor donde se almacenan los datos del espacio de trabajo.


endif::azure[]

ifdef::gcp[]

* Para los backups almacenados en Google Cloud, aprovisiona un nuevo bloque y el https://cloud.google.com/bigquery["Servicios de Google Cloud BigQuery"^] se aprovisionan en el nivel de cuenta/proyecto.


endif::gcp[]

* Para backups almacenados en StorageGRID, aprovisiona espacio en el conector o en el entorno del proveedor de cloud.


Si ya se ha activado la indización para el entorno de trabajo, vaya a la siguiente sección para restaurar los datos.

Para habilitar la indización para un entorno de trabajo:

* Si no se han indizado los entornos de trabajo, en el Panel de restauración, en _Search & Restore_, haga clic en *Activar indexación para entornos de trabajo* y haga clic en *Activar indexación* para el entorno de trabajo.
* Si ya se ha indizado al menos un entorno de trabajo, en el Panel de restauración, en _Search & Restore_, haga clic en *Configuración de indexación* y haga clic en *Activar indexación* para el entorno de trabajo.


Una vez que se han aprovisionado todos los servicios y se ha activado el catálogo indexado, el entorno de trabajo se muestra como "activo".

image:screenshot_restore_enable_indexing.png["Captura de pantalla que muestra los entornos de trabajo que han activado el catálogo indexado."]

En función del tamaño de los volúmenes del entorno de trabajo y del número de archivos de backup en el cloud, el proceso de indexación inicial puede tardar hasta una hora. Después, se actualiza de forma transparente cada hora con cambios incrementales para mantenerse al día.



=== Restaurar volúmenes, carpetas y archivos mediante Search & Restore

Después de haberlo hecho <<Activación del catálogo indexado para cada entorno de trabajo,Indexación activada para el entorno de trabajo>>, Puede restaurar volúmenes, carpetas y archivos mediante Buscar y restaurar. Esto le permite utilizar una amplia gama de filtros para encontrar el archivo o volumen exacto que desea restaurar desde todos los archivos de copia de seguridad.

.Pasos
. En el menú BlueXP, seleccione *Protección > copia de seguridad y recuperación*.
. Haga clic en la ficha *Restaurar* y aparecerá el Panel de restauración.
. En la sección _Search & Restore_, haga clic en *Search & Restore*.
+
image:screenshot_restore_start_search_restore.png["Captura de pantalla de la selección del botón Search  Restore del panel Restore."]

. Desde la página Buscar en Restaurar:
+
.. En la barra _Search_, introduzca un nombre de volumen completo o parcial, un nombre de carpeta o un nombre de archivo.
.. Seleccione el tipo de recurso: *Volúmenes*, *Archivos*, *carpetas* o *todo*.
.. En el área _Filter by_, seleccione los criterios de filtro. Por ejemplo, puede seleccionar el entorno de trabajo donde residen los datos y el tipo de archivo, por ejemplo un archivo .JPEG.


. Haga clic en *Buscar* y el área resultados de la búsqueda mostrará todos los recursos que tengan un archivo, carpeta o volumen que coincida con la búsqueda.
+
image:screenshot_restore_step1_search_restore.png["Captura de pantalla que muestra los criterios de búsqueda y los resultados de búsqueda en la página Buscar  Restaurar."]

. Haga clic en *Ver todas las copias de seguridad* del recurso que contiene los datos que desea restaurar para mostrar todos los archivos de copia de seguridad que contienen el volumen, carpeta o archivo coincidente.
+
image:screenshot_restore_step2_search_restore.png["Una captura de pantalla que muestra cómo ver todas las copias de seguridad que coinciden con los criterios de búsqueda."]

. Haga clic en *Restaurar* para el archivo de copia de seguridad que desea utilizar para restaurar el elemento de la nube.
+
Tenga en cuenta que los resultados también identifican las copias Snapshot de volumen local que contienen el archivo en la búsqueda. El botón *Restaurar* no funciona para instantáneas en este momento, pero si desea restaurar los datos de la copia Snapshot en lugar de hacerlo desde el archivo copia de seguridad, anote el nombre y la ubicación del volumen, abra la página Detalles del volumen en el lienzo, Y utilice la opción *Restaurar desde copia Snapshot*.

. Seleccione la ubicación de destino en la que desea restaurar el volumen, la carpeta o los archivos y haga clic en *Restaurar*.
+
** Para los volúmenes, es posible seleccionar el entorno de trabajo de destino original o bien seleccionar un entorno de trabajo alternativo. Al restaurar un volumen de FlexGroup, puede elegir varios agregados.
** Para las carpetas, puede restaurar a la ubicación original o seleccionar una ubicación alternativa, incluido el entorno de trabajo, el volumen y la carpeta.
** Para los archivos, es posible restaurar a la ubicación original o seleccionar una ubicación alternativa, incluido el entorno de trabajo, el volumen y la carpeta. Al seleccionar la ubicación original, puede elegir sobrescribir los archivos de origen o crear archivos nuevos.
+
Si selecciona un sistema ONTAP en las instalaciones y todavía no ha configurado la conexión de clúster con el almacenamiento de objetos, se le pedirá información adicional:

+
ifdef::aws[]

+
*** Al restaurar desde Amazon S3, seleccione el espacio IP del clúster de ONTAP en el que residirá el volumen de destino, introduzca la clave de acceso y la clave secreta del usuario que creó para permitir el acceso del clúster ONTAP al bloque de S3, Y, opcionalmente, elegir un extremo privado VPC para una transferencia de datos segura. link:task-backup-onprem-to-aws.html#cluster-networking-requirements["Consulte los detalles de estos requisitos"].






endif::aws[]

ifdef::azure[]

* Al restaurar desde Azure Blob, seleccione el espacio IP en el clúster de ONTAP donde reside el volumen de destino y, opcionalmente, elija un extremo privado para la transferencia de datos segura mediante la selección de la red y la subred. link:task-backup-onprem-to-azure.html#requirements["Consulte los detalles de estos requisitos"].


endif::azure[]

ifdef::gcp[]

* Al restaurar desde Google Cloud Storage, seleccione el espacio IP del clúster de ONTAP en el que residirá el volumen de destino y la clave de acceso y clave secreta para acceder al almacenamiento de objetos. link:task-backup-onprem-to-gcp.html#requirements["Consulte los detalles de estos requisitos"].


endif::gcp[]

* Al restaurar desde StorageGRID, introduzca el FQDN del servidor StorageGRID y el puerto que ONTAP debe usar para la comunicación HTTPS con StorageGRID, introduzca la clave de acceso y la clave secreta necesarias para acceder al almacenamiento de objetos, y el espacio IP del clúster ONTAP en el que reside el volumen de destino. link:task-backup-onprem-private-cloud.html#requirements["Consulte los detalles de estos requisitos"].


.Resultados
Se restauran el volumen, la carpeta o los archivos y se devuelve a la consola de restauración para poder revisar el progreso de la operación de restauración. También puede hacer clic en la ficha *Supervisión de trabajos* para ver el progreso de la restauración.

Para los volúmenes restaurados, es posible link:task-manage-backups-ontap.html["gestione la configuración de backup para este nuevo volumen"] según sea necesario.
